<launch>
    <arg name="GoalTopic"               value="/clicked_point" />
    <arg name="PlanTopic"               value="/move_base/action_plan" />
    <arg name="PublishFrequency"        value="0.01" />
    <arg name="OdomTopic"               value="/robot_position_in_map" />
    <arg name="MotionTopice"            value='cmd_vel_mux/input/smoother' />

    <arg name="fixed_path"              default="True"/>

    <arg name="CmdTopice"               value='cmd_vel_mux/input/navi' />
    <include file="$(find nav_staff)/launch/xml/cmd_smoother.launch.xml">
        <arg name="MotionTopice"          value="$(arg MotionTopice)" />
        <arg name="CmdTopice"             value="$(arg CmdTopice)" />
    </include>
    <!--<include file="$(find nav_staff)/launch/xml/safety_controller.launch.xml"/>-->    

    <!--base controller-->
    <arg name="PathAcc"                 default='5.0' />
    <arg name="MaxLinearSP"             default='0.5' />
    <arg name="MinLinearSP"             default='0.1' />
    <arg name="AngularSP"               default='0.3' />
    <arg name="AngularBias"             default='0.3' />
    <arg name="AngularFree"             default="0.1745"/>
    <arg name="GoalTolerant"            default="0.01"/>
    <arg name="visual_test"             default="True"/>
    <arg name="FixedPlanTopic"          default="/move_base/action_plan/fixed"/>

    <arg if="$(arg fixed_path)" name="MovebasePlanTopic" value="$(arg FixedPlanTopic)" />
    <arg unless="$(arg fixed_path)" name="MovebasePlanTopic" value="$(arg PlanTopic)" />

    <node pkg="nav_staff" type="base_controller.py" respawn="true" name="BaseController_X" output="screen">

        <param name="PlanTopic"         value="$(arg MovebasePlanTopic)" />
        <param name="OdomTopic"         value="$(arg OdomTopic)" />
        <param name="MotionTopice"      value="$(arg MotionTopice)" />

        <param name="PathAcc"           value="$(arg PathAcc)" />
        <param name="MaxLinearSP"       value="$(arg MaxLinearSP)" />
        <param name="MinLinearSP"       value="$(arg MinLinearSP)" />
        <param name="AngularSP"         value="$(arg AngularSP)" />

        <param name="AngularBias"       value="$(arg AngularBias)" />
        <param name="AngularFree"       value="$(arg AngularFree)" />
        <param name="PublishFrequency"  value="$(arg PublishFrequency)" />
        <param name="GoalTolerant"      value="$(arg GoalTolerant)" />

        <param name="visual_test"       value="$(arg visual_test)" />
    </node>


    <include if="$(arg fixed_path)" file="$(find nav_staff)/launch/xml/fixed_plan_maker.launch.xml" />

    <!--&lt;!&ndash; plan fixer&ndash;&gt;-->
    <!--<arg name="PositionFree" default="0.1" />-->
    <!--<arg name="ActionPlanTopic" default="/move_base/action_plan" />-->
    <!--<arg name="RawPlanTopic" default='/move_base/NavfnROS/plan' />-->

    <!--<node pkg="nav_staff" type="plan_fixer.py" respawn="true" name="Planfixer" output="screen">-->
        <!--<param name="RawPlanTopic" value="$(arg RawPlanTopic)"/>-->
        <!--<param name="OdomTopic" value="$(arg OdomTopic)"/>-->

        <!--<param name="PositionFree" value="$(arg PositionFree)"/>-->
        <!--<param name="ActionPlanTopic" value="$(arg ActionPlanTopic)"/>-->
        <!--<param name="GoalTopic" value="$(arg GoalTopic)"/>-->
    <!--</node>-->

    <!--planner-->
    <arg name="MapTopic"                    default="/cost_plan_map" />
    <arg name="visual_debug"                default="True" />
    <arg name="detect_scale"                default="30" />
    <node pkg="nav_staff" type="Planner.py" respawn="true" name="Planner" output="screen">
        <param name="GoalTopic"               value="$(arg GoalTopic)" />
        <param name="MapTopic"                value="$(arg MapTopic)" />
        <param name="PlanTopic"               value="$(arg PlanTopic)" />
        <param name="PublishFrequency"        value="$(arg PublishFrequency)" />
        <param name="OdomTopic"               value="$(arg OdomTopic)" />
        <param name="visual_debug"            value="$(arg visual_debug)" />
        <param name="detect_scale"            value="$(arg detect_scale)" />
    </node>

    <!--cost plan map-->
    <arg name="obstacle_thread"         value="80" />
    <arg name="root_topic"              value="/test_obstacles" />
    <arg name="devergency_scale"        value="7" />
    <arg name="use_map_topic"           value="/map" />
    <arg name="publish_hz"              value="0.01" />
    <arg name="use_plan_map_topic"      value="/cost_plan_map" />
    <include file="$(find nav_staff)/launch/xml/cost_plan_map.launch.xml">
        <arg name="obstacle_thread"       value="$(arg obstacle_thread)"/>
        <arg name="root_topic"            value="$(arg root_topic)"/>
        <arg name="devergency_scale"      value="$(arg devergency_scale)"/>
        <arg name="use_map_topic"         value="$(arg use_map_topic)"/>
        <arg name="publish_hz"            value="$(arg publish_hz)"/>
        <arg name="use_plan_map_topic"    value="$(arg use_plan_map_topic)"/>
    </include>

</launch>
